<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Adding Papers and Slides to a Snakemake Workflow | Reproducible Data Analytic Workflows with Snakemake and R</title>
  <meta name="description" content="In progress" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Adding Papers and Slides to a Snakemake Workflow | Reproducible Data Analytic Workflows with Snakemake and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="In progress" />
  <meta name="github-repo" content="lachlandeer/snakemake-econ-r-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Adding Papers and Slides to a Snakemake Workflow | Reproducible Data Analytic Workflows with Snakemake and R" />
  
  <meta name="twitter:description" content="In progress" />
  

<meta name="author" content="Ulrich Bergmann" />
<meta name="author" content="Lachlan Deer" />
<meta name="author" content="Julian Langer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-rule-to-rule-them-all.html"/>
<link rel="next" href="logging-output-and-errors.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>
<div style="text-align:center">
<li><a href="./index.html">Reproducible Data Analytic <br /> Workflows with Snakemake and `R`</a></li>
</div>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-we-wrote-this-tutorial"><i class="fa fa-check"></i>Why we wrote this tutorial</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisite-knowledge"><i class="fa fa-check"></i>Pre-requisite Knowledge</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-needs-to-be-downloaded-installed-for-this-tutorial"><i class="fa fa-check"></i>What Needs to be Downloaded &amp; Installed for this Tutorial</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#template-scripts-and-documents"><i class="fa fa-check"></i>Template Scripts and Documents</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-installation"><i class="fa fa-check"></i>Software Installation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-we-cant-cover"><i class="fa fa-check"></i>What We Can’t Cover</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructional-material"><i class="fa fa-check"></i>Instructional material</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i>Software</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Motivating &amp; Rationale</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-case-for-reproducibility"><i class="fa fa-check"></i><b>1.1</b> A Case for Reproducibility</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#how-far-to-go-in-the-quest-for-reproducibility"><i class="fa fa-check"></i><b>1.1.1</b> How far to go in the quest for reproducibility?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-is-snakemake-why-should-you-use-it"><i class="fa fa-check"></i><b>1.2</b> What is <code>Snakemake</code> &amp; Why Should you use it?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#why-r"><i class="fa fa-check"></i><b>1.3</b> Why <code>R</code>?</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#working-example-replicating-mankiw-romer-and-weils-1992-qje"><i class="fa fa-check"></i><b>1.4</b> Working Example: Replicating Mankiw, Romer and Weil’s 1992 QJE</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#the-way-forward"><i class="fa fa-check"></i><b>1.5</b> The way forward</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#exercise-your-own-projects-steps"><i class="fa fa-check"></i>Exercise: Your own project’s steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="project-organization.html"><a href="project-organization.html"><i class="fa fa-check"></i><b>2</b> Project Organization</a><ul>
<li class="chapter" data-level="" data-path="project-organization.html"><a href="project-organization.html#learning-objectives-1"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="2.1" data-path="project-organization.html"><a href="project-organization.html#subtitle-tbd"><i class="fa fa-check"></i><b>2.1</b> Subtitle TBD</a></li>
<li class="chapter" data-level="2.2" data-path="project-organization.html"><a href="project-organization.html#project-organization-i-separating-inputs-and-outputs"><i class="fa fa-check"></i><b>2.2</b> Project Organization I: Separating Inputs and Outputs</a></li>
<li class="chapter" data-level="2.3" data-path="project-organization.html"><a href="project-organization.html#project-structure-ii-separating-logical-chunks-of-the-project"><i class="fa fa-check"></i><b>2.3</b> Project Structure II: Separating Logical Chunks of the Project</a><ul>
<li class="chapter" data-level="2.3.1" data-path="project-organization.html"><a href="project-organization.html#aside-even-deeper-sub-folders"><i class="fa fa-check"></i><b>2.3.1</b> Aside: Even Deeper Sub-folders</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="project-organization.html"><a href="project-organization.html#project-structure-iii-separating-input-parameters-from-code"><i class="fa fa-check"></i><b>2.4</b> Project Structure III: Separating Input Parameters from Code</a></li>
</ul></li>
<li class="part"><span><b>II Basic Snakemake Workflows</b></span></li>
<li class="chapter" data-level="3" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html"><i class="fa fa-check"></i><b>3</b> Initial Steps with Snakemake</a><ul>
<li class="chapter" data-level="3.1" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#writing-our-first-rule"><i class="fa fa-check"></i><b>3.1</b> Writing Our First Rule</a></li>
<li class="chapter" data-level="3.2" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#executing-a-rule"><i class="fa fa-check"></i><b>3.2</b> Executing a Rule</a></li>
<li class="chapter" data-level="3.3" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#first-steps-in-the-mrw-pipeline"><i class="fa fa-check"></i><b>3.3</b> First Steps in the MRW Pipeline</a><ul>
<li class="chapter" data-level="3.3.1" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#using-the-rscript-command-to-execute-r-scripts"><i class="fa fa-check"></i><b>3.3.1</b> Using the <code>Rscript</code> command to execute R scripts</a></li>
<li class="chapter" data-level="3.3.2" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#the-input-and-output-arguments"><i class="fa fa-check"></i><b>3.3.2</b> The <code>input</code> and <code>output</code> arguments</a></li>
<li class="chapter" data-level="3.3.3" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#a-rule-to-rename-variables."><i class="fa fa-check"></i><b>3.3.3</b> A rule to rename variables.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#no-redundant-executions"><i class="fa fa-check"></i><b>3.4</b> No Redundant Executions</a></li>
<li class="chapter" data-level="3.5" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#our-workflow-in-graphs"><i class="fa fa-check"></i><b>3.5</b> Our Workflow in Graphs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html"><i class="fa fa-check"></i><b>4</b> Working With Multiple Rules</a><ul>
<li class="chapter" data-level="4.1" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html#creating-a-second-rule"><i class="fa fa-check"></i><b>4.1</b> Creating a Second Rule</a></li>
<li class="chapter" data-level="4.2" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html#rule-order-matters"><i class="fa fa-check"></i><b>4.2</b> Rule Order Matters</a></li>
<li class="chapter" data-level="4.3" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html#dependencies-between-rules"><i class="fa fa-check"></i><b>4.3</b> Dependencies Between Rules</a></li>
<li class="chapter" data-level="4.4" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html#clean-rules"><i class="fa fa-check"></i><b>4.4</b> Clean Rules</a></li>
<li class="chapter" data-level="4.5" data-path="working-with-multiple-rules.html"><a href="working-with-multiple-rules.html#our-workflow-in-graphs-1"><i class="fa fa-check"></i><b>4.5</b> Our Workflow in Graphs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="target-rules.html"><a href="target-rules.html"><i class="fa fa-check"></i><b>5</b> Target Rules</a><ul>
<li class="chapter" data-level="5.1" data-path="target-rules.html"><a href="target-rules.html#where-we-are-now"><i class="fa fa-check"></i><b>5.1</b> Where we are now?</a></li>
<li class="chapter" data-level="5.2" data-path="target-rules.html"><a href="target-rules.html#how-snakemake-determines-the-build-order-when-multiple-rules-are-present"><i class="fa fa-check"></i><b>5.2</b> How Snakemake determines the build order when multiple rules are present</a></li>
<li class="chapter" data-level="5.3" data-path="target-rules.html"><a href="target-rules.html#dedicated-target-rules-to-execute-multiple-rules"><i class="fa fa-check"></i><b>5.3</b> Dedicated target rules to execute multiple rules</a><ul>
<li class="chapter" data-level="" data-path="target-rules.html"><a href="target-rules.html#exercise-using-target-rules"><i class="fa fa-check"></i>Exercise: Using target rules</a></li>
<li class="chapter" data-level="" data-path="target-rules.html"><a href="target-rules.html#solution-2"><i class="fa fa-check"></i>Solution</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="target-rules.html"><a href="target-rules.html#target-rules-can-do-more-for-us"><i class="fa fa-check"></i><b>5.4</b> Target rules can do more for us</a></li>
</ul></li>
<li class="part"><span><b>III Minimizing Repetition, Maximizing Generalizability</b></span></li>
<li class="chapter" data-level="6" data-path="wildcards.html"><a href="wildcards.html"><i class="fa fa-check"></i><b>6</b> Wildcards</a><ul>
<li class="chapter" data-level="6.1" data-path="wildcards.html"><a href="wildcards.html#the-starting-point-of-our-snakefile"><i class="fa fa-check"></i><b>6.1</b> The starting point of our Snakefile</a></li>
<li class="chapter" data-level="6.2" data-path="wildcards.html"><a href="wildcards.html#using-wildcards-to-tidy-up-our-code"><i class="fa fa-check"></i><b>6.2</b> Using wildcards to tidy up our code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html"><i class="fa fa-check"></i><b>7</b> Automatic Expansion of Wildcards</a><ul>
<li class="chapter" data-level="7.1" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#learning-goals"><i class="fa fa-check"></i><b>7.1</b> Learning Goals</a></li>
<li class="chapter" data-level="7.2" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#the-expand-function"><i class="fa fa-check"></i><b>7.2</b> The <code>expand()</code> function</a><ul>
<li class="chapter" data-level="" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#exercise-exploring-the-expand-function-i"><i class="fa fa-check"></i>Exercise: Exploring the expand function I</a></li>
<li class="chapter" data-level="7.2.1" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#solution-3"><i class="fa fa-check"></i><b>7.2.1</b> SOLUTION:</a></li>
<li class="chapter" data-level="" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#exercise-exploring-the-expand-function-ii"><i class="fa fa-check"></i>Exercise: Exploring the expand() function II</a></li>
<li class="chapter" data-level="7.2.2" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#solution-4"><i class="fa fa-check"></i><b>7.2.2</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="automatic-expansion-of-wildcards.html"><a href="automatic-expansion-of-wildcards.html#expanding-multiple-wildcards"><i class="fa fa-check"></i><b>7.3</b> Expanding Multiple Wildcards</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html"><i class="fa fa-check"></i><b>8</b> Automating List Construction for Wildcard Expansion</a><ul>
<li class="chapter" data-level="8.1" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#state-of-the-snakefile"><i class="fa fa-check"></i><b>8.2</b> State of the Snakefile</a></li>
<li class="chapter" data-level="8.3" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#the-glob_wildcards-function"><i class="fa fa-check"></i><b>8.3</b> The <code>glob_wildcards</code> Function</a></li>
<li class="chapter" data-level="8.4" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#looking-at-the-dag-redux"><i class="fa fa-check"></i><b>8.4</b> Looking at the DAG (redux)</a><ul>
<li class="chapter" data-level="" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#exercise-exploring-glob_wildcards"><i class="fa fa-check"></i>Exercise: Exploring glob_wildcards()</a></li>
<li class="chapter" data-level="8.4.1" data-path="automating-list-construction-for-wildcard-expansion.html"><a href="automating-list-construction-for-wildcard-expansion.html#solution-5"><i class="fa fa-check"></i><b>8.4.1</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Bringing Many Outputs Together</b></span></li>
<li class="chapter" data-level="9" data-path="make-tables.html"><a href="make-tables.html"><i class="fa fa-check"></i><b>9</b> Make Tables</a><ul>
<li class="chapter" data-level="9.1" data-path="make-tables.html"><a href="make-tables.html#the-state-of-the-snakefile"><i class="fa fa-check"></i><b>9.1</b> The State of the Snakefile</a></li>
<li class="chapter" data-level="9.2" data-path="make-tables.html"><a href="make-tables.html#building-a-single-table"><i class="fa fa-check"></i><b>9.2</b> Building a single table</a></li>
<li class="chapter" data-level="9.3" data-path="make-tables.html"><a href="make-tables.html#building-all-tables-at-once"><i class="fa fa-check"></i><b>9.3</b> Building all tables at once</a><ul>
<li class="chapter" data-level="" data-path="make-tables.html"><a href="make-tables.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="make-tables.html"><a href="make-tables.html#solution-6"><i class="fa fa-check"></i>Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="one-rule-to-rule-them-all.html"><a href="one-rule-to-rule-them-all.html"><i class="fa fa-check"></i><b>10</b> One rule to rule them all</a><ul>
<li class="chapter" data-level="10.1" data-path="one-rule-to-rule-them-all.html"><a href="one-rule-to-rule-them-all.html#the-state-of-the-snakefile-1"><i class="fa fa-check"></i><b>10.1</b> The State of the Snakefile</a></li>
<li class="chapter" data-level="10.2" data-path="one-rule-to-rule-them-all.html"><a href="one-rule-to-rule-them-all.html#creating-an-all-target-rule"><i class="fa fa-check"></i><b>10.2</b> Creating an <code>all</code> target rule</a></li>
<li class="chapter" data-level="10.3" data-path="one-rule-to-rule-them-all.html"><a href="one-rule-to-rule-them-all.html#concluding-remarks"><i class="fa fa-check"></i><b>10.3</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html"><i class="fa fa-check"></i><b>11</b> Adding Papers and Slides to a Snakemake Workflow</a><ul>
<li class="chapter" data-level="11.1" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#learning-objectives-3"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#state-of-our-snakefile"><i class="fa fa-check"></i><b>11.2</b> State of Our Snakefile</a></li>
<li class="chapter" data-level="11.3" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#where-we-are"><i class="fa fa-check"></i><b>11.3</b> Where We Are</a></li>
<li class="chapter" data-level="11.4" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#building-a-paper"><i class="fa fa-check"></i><b>11.4</b> Building a Paper</a></li>
<li class="chapter" data-level="11.5" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#integrating-build_paper-output-into-all"><i class="fa fa-check"></i><b>11.5</b> Integrating <code>build_paper</code> output into <code>all</code></a></li>
<li class="chapter" data-level="11.6" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#making-paper.pdf-easier-to-find"><i class="fa fa-check"></i><b>11.6</b> Making <code>paper.pdf</code> Easier to Find</a><ul>
<li class="chapter" data-level="11.6.1" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#exercise-adding-a-slide-deck."><i class="fa fa-check"></i><b>11.6.1</b> Exercise: Adding a Slide Deck.</a></li>
<li class="chapter" data-level="11.6.2" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#exercise-solution"><i class="fa fa-check"></i><b>11.6.2</b> Exercise Solution</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="adding-papers-and-slides-to-a-snakemake-workflow.html"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#final-thoughts"><i class="fa fa-check"></i><b>11.7</b> Final Thoughts</a></li>
</ul></li>
<li class="part"><span><b>V Decorating Snakemake Workflows</b></span></li>
<li class="chapter" data-level="12" data-path="logging-output-and-errors.html"><a href="logging-output-and-errors.html"><i class="fa fa-check"></i><b>12</b> Logging Output and Errors</a><ul>
<li class="chapter" data-level="12.1" data-path="logging-output-and-errors.html"><a href="logging-output-and-errors.html#logging-output"><i class="fa fa-check"></i><b>12.1</b> Logging Output</a></li>
<li class="chapter" data-level="12.2" data-path="logging-output-and-errors.html"><a href="logging-output-and-errors.html#logging-output-and-errors-in-one-file"><i class="fa fa-check"></i><b>12.2</b> Logging Output and Errors in One File</a><ul>
<li class="chapter" data-level="" data-path="logging-output-and-errors.html"><a href="logging-output-and-errors.html#exercise-logging-all-r-scripts"><i class="fa fa-check"></i>Exercise: Logging all R Scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="adding-parameters.html"><a href="adding-parameters.html"><i class="fa fa-check"></i><b>13</b> Adding Parameters</a><ul>
<li class="chapter" data-level="13.1" data-path="adding-parameters.html"><a href="adding-parameters.html#motivating-example-constructing-a-regression-table-from-ols-results"><i class="fa fa-check"></i><b>13.1</b> Motivating Example: Constructing a Regression Table from OLS Results</a></li>
<li class="chapter" data-level="13.2" data-path="adding-parameters.html"><a href="adding-parameters.html#creating-a-rule-with-params"><i class="fa fa-check"></i><b>13.2</b> Creating a Rule with <code>params</code></a><ul>
<li class="chapter" data-level="" data-path="adding-parameters.html"><a href="adding-parameters.html#exercise-building-table-2"><i class="fa fa-check"></i>Exercise: Building Table 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="config-files.html"><a href="config-files.html"><i class="fa fa-check"></i><b>14</b> Config Files</a><ul>
<li class="chapter" data-level="14.1" data-path="config-files.html"><a href="config-files.html#the-config.yaml-filepath"><i class="fa fa-check"></i><b>14.1</b> The <code>config.yaml</code> filepath</a></li>
<li class="chapter" data-level="14.2" data-path="config-files.html"><a href="config-files.html#using-paths-from-the-config-file"><i class="fa fa-check"></i><b>14.2</b> Using paths from the config file</a><ul>
<li class="chapter" data-level="" data-path="config-files.html"><a href="config-files.html#exercise-using-config-files"><i class="fa fa-check"></i>Exercise: Using Config Files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="self-documenting-help.html"><a href="self-documenting-help.html"><i class="fa fa-check"></i><b>15</b> Self Documenting Help</a><ul>
<li class="chapter" data-level="15.1" data-path="self-documenting-help.html"><a href="self-documenting-help.html#our-commenting-syle"><i class="fa fa-check"></i><b>15.1</b> Our Commenting Syle</a></li>
<li class="chapter" data-level="15.2" data-path="self-documenting-help.html"><a href="self-documenting-help.html#adding-further-comments"><i class="fa fa-check"></i><b>15.2</b> Adding Further Comments</a><ul>
<li class="chapter" data-level="" data-path="self-documenting-help.html"><a href="self-documenting-help.html#exercise-adding-comments"><i class="fa fa-check"></i>Exercise: Adding Comments</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="self-documenting-help.html"><a href="self-documenting-help.html#a-help-rule"><i class="fa fa-check"></i><b>15.3</b> A <code>help</code> Rule</a><ul>
<li><a href="self-documenting-help.html#exercise-saving-help-output-to-file">Exercise: Saving <code>help</code> output to file</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="subworkflows-divide-and-conquer.html"><a href="subworkflows-divide-and-conquer.html"><i class="fa fa-check"></i><b>16</b> Subworkflows: Divide and Conquer</a><ul>
<li class="chapter" data-level="16.1" data-path="subworkflows-divide-and-conquer.html"><a href="subworkflows-divide-and-conquer.html#subworkflow-basics"><i class="fa fa-check"></i><b>16.1</b> Subworkflow Basics</a></li>
<li class="chapter" data-level="16.2" data-path="subworkflows-divide-and-conquer.html"><a href="subworkflows-divide-and-conquer.html#subworkflow-dependencies"><i class="fa fa-check"></i><b>16.2</b> Subworkflow dependencies</a><ul>
<li class="chapter" data-level="" data-path="subworkflows-divide-and-conquer.html"><a href="subworkflows-divide-and-conquer.html#exercise-more-subworkflows"><i class="fa fa-check"></i>Exercise: More Subworkflows</a></li>
<li><a href="subworkflows-divide-and-conquer.html#guided-exercise-help-rules-with-subworkflows">Guided Exercise: <code>help</code> rules with subworkflows</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Putting Workflows in a Box</b></span></li>
<li class="chapter" data-level="17" data-path="package-dependencies-with-renv.html"><a href="package-dependencies-with-renv.html"><i class="fa fa-check"></i><b>17</b> Package Dependencies with <code>renv</code></a></li>
<li class="chapter" data-level="18" data-path="containers.html"><a href="containers.html"><i class="fa fa-check"></i><b>18</b> Containers</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="installation-guide.html"><a href="installation-guide.html"><i class="fa fa-check"></i><b>A</b> Installation Guide</a><ul>
<li class="chapter" data-level="A.1" data-path="installation-guide.html"><a href="installation-guide.html#windows"><i class="fa fa-check"></i><b>A.1</b> Windows</a><ul>
<li class="chapter" data-level="A.1.1" data-path="installation-guide.html"><a href="installation-guide.html#bash-terminal"><i class="fa fa-check"></i><b>A.1.1</b> Bash terminal</a></li>
<li class="chapter" data-level="A.1.2" data-path="installation-guide.html"><a href="installation-guide.html#python"><i class="fa fa-check"></i><b>A.1.2</b> Python</a></li>
<li class="chapter" data-level="" data-path="installation-guide.html"><a href="installation-guide.html#installing-snakemake"><i class="fa fa-check"></i>Installing Snakemake</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="installation-guide.html"><a href="installation-guide.html#mac"><i class="fa fa-check"></i><b>A.2</b> Mac</a><ul>
<li class="chapter" data-level="A.2.1" data-path="installation-guide.html"><a href="installation-guide.html#bash-terminal-1"><i class="fa fa-check"></i><b>A.2.1</b> Bash terminal</a></li>
<li class="chapter" data-level="A.2.2" data-path="installation-guide.html"><a href="installation-guide.html#python-1"><i class="fa fa-check"></i><b>A.2.2</b> Python</a></li>
<li class="chapter" data-level="" data-path="installation-guide.html"><a href="installation-guide.html#installing-snakemake-1"><i class="fa fa-check"></i>Installing Snakemake</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="installation-guide.html"><a href="installation-guide.html#linux-ubuntu"><i class="fa fa-check"></i><b>A.3</b> Linux / Ubuntu</a><ul>
<li class="chapter" data-level="A.3.1" data-path="installation-guide.html"><a href="installation-guide.html#bash-terminal-2"><i class="fa fa-check"></i><b>A.3.1</b> Bash terminal</a></li>
<li class="chapter" data-level="A.3.2" data-path="installation-guide.html"><a href="installation-guide.html#python-2"><i class="fa fa-check"></i><b>A.3.2</b> Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>B</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.comlachlandeer/snakemake-econ-r/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Data Analytic Workflows with Snakemake and <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="adding-papers-and-slides-to-a-snakemake-workflow" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Adding Papers and Slides to a Snakemake Workflow</h1>
<div id="learning-objectives-3" class="section level2">
<h2><span class="header-section-number">11.1</span> Learning Objectives</h2>
<p>TBD</p>
<p>!! TODO: warning on Rmarkdown / bookdown etc installs</p>
</div>
<div id="state-of-our-snakefile" class="section level2">
<h2><span class="header-section-number">11.2</span> State of Our Snakefile</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb167-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-1"></a><span class="ex">MODELS</span> = glob_wildcards(<span class="st">&quot;src/model-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span> </span>
<span id="cb167-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-2"></a></span>
<span id="cb167-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-3"></a><span class="co"># note this filter is only needed coz we are running an older version of the src files, will be updated soon</span></span>
<span id="cb167-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-4"></a><span class="ex">DATA_SUBSET</span> = glob_wildcards(<span class="st">&quot;src/data-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb167-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-5"></a><span class="ex">DATA_SUBSET</span> = list(filter(lambda x: x.startswith(<span class="st">&quot;subset&quot;</span>), <span class="ex">DATA_SUBSET</span>))</span>
<span id="cb167-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-6"></a></span>
<span id="cb167-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-7"></a><span class="ex">PLOTS</span> = glob_wildcards(<span class="st">&quot;src/figures/{fname}.R&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb167-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-8"></a></span>
<span id="cb167-9"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-9"></a><span class="ex">TABLES</span> = glob_wildcards(<span class="st">&quot;src/table-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb167-10"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-10"></a></span>
<span id="cb167-11"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-11"></a></span>
<span id="cb167-12"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-12"></a><span class="co">##############################################</span></span>
<span id="cb167-13"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-13"></a><span class="co"># TARGETS</span></span>
<span id="cb167-14"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-14"></a><span class="co">##############################################</span></span>
<span id="cb167-15"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-15"></a></span>
<span id="cb167-16"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-16"></a><span class="ex">rule</span> all:</span>
<span id="cb167-17"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-17"></a>    <span class="ex">input</span>:</span>
<span id="cb167-18"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-18"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,</span>
<span id="cb167-19"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-19"></a>                    <span class="ex">iFigure</span> = PLOTS),</span>
<span id="cb167-20"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-20"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/tables/{iTable}.tex&quot;</span>,</span>
<span id="cb167-21"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-21"></a>                    <span class="ex">iTable</span> = TABLES) </span>
<span id="cb167-22"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-22"></a></span>
<span id="cb167-23"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-23"></a><span class="ex">rule</span> make_tables:</span>
<span id="cb167-24"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-24"></a>    <span class="ex">input</span>:</span>
<span id="cb167-25"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-25"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/tables/{iTable}.tex&quot;</span>,</span>
<span id="cb167-26"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-26"></a>                <span class="ex">iTable</span> = TABLES)</span>
<span id="cb167-27"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-27"></a></span>
<span id="cb167-28"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-28"></a><span class="ex">rule</span> run_models:</span>
<span id="cb167-29"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-29"></a>    <span class="ex">input</span>:</span>
<span id="cb167-30"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-30"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span>,</span>
<span id="cb167-31"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-31"></a>                    <span class="ex">iSubset</span> = DATA_SUBSET,</span>
<span id="cb167-32"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-32"></a>                    <span class="ex">iModel</span> = MODELS)</span>
<span id="cb167-33"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-33"></a></span>
<span id="cb167-34"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-34"></a><span class="ex">rule</span> make_figures:</span>
<span id="cb167-35"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-35"></a>    <span class="ex">input</span>:</span>
<span id="cb167-36"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-36"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,</span>
<span id="cb167-37"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-37"></a>                    <span class="ex">iFigure</span> = PLOTS)</span>
<span id="cb167-38"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-38"></a></span>
<span id="cb167-39"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-39"></a></span>
<span id="cb167-40"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-40"></a><span class="co">##############################################</span></span>
<span id="cb167-41"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-41"></a><span class="co"># INTERMEDIATE RULES</span></span>
<span id="cb167-42"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-42"></a><span class="co">##############################################</span></span>
<span id="cb167-43"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-43"></a></span>
<span id="cb167-44"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-44"></a><span class="co"># table: build one table</span></span>
<span id="cb167-45"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-45"></a><span class="ex">rule</span> table:</span>
<span id="cb167-46"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-46"></a>    <span class="ex">input</span>:</span>
<span id="cb167-47"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-47"></a>        <span class="ex">script</span> = <span class="st">&quot;src/tables/regression_table.R&quot;</span>,</span>
<span id="cb167-48"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-48"></a>        <span class="ex">spec</span>   = <span class="st">&quot;src/table-specs/{iTable}.json&quot;</span>,</span>
<span id="cb167-49"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-49"></a>        <span class="ex">models</span> = expand(<span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span>,</span>
<span id="cb167-50"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-50"></a>                        <span class="ex">iModel</span> = MODELS,</span>
<span id="cb167-51"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-51"></a>                        <span class="ex">iSubset</span> = DATA_SUBSET),</span>
<span id="cb167-52"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-52"></a>    <span class="ex">output</span>:</span>
<span id="cb167-53"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-53"></a>        <span class="ex">table</span> = <span class="st">&quot;out/tables/{iTable}.tex&quot;</span></span>
<span id="cb167-54"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-54"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-55"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-55"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb167-56"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-56"></a><span class="st">            --spec {input.spec} \</span></span>
<span id="cb167-57"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-57"></a><span class="st">            --out {output.table}&quot;</span></span>
<span id="cb167-58"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-58"></a></span>
<span id="cb167-59"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-59"></a><span class="ex">rule</span> model:</span>
<span id="cb167-60"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-60"></a>    <span class="ex">input</span>:</span>
<span id="cb167-61"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-61"></a>        <span class="ex">script</span> = <span class="st">&quot;src/analysis/estimate_ols_model.R&quot;</span>,</span>
<span id="cb167-62"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-62"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span>,</span>
<span id="cb167-63"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-63"></a>        <span class="ex">model</span>  = <span class="st">&quot;src/model-specs/{iModel}.json&quot;</span>,</span>
<span id="cb167-64"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-64"></a>        <span class="ex">subset</span> = <span class="st">&quot;src/data-specs/{iSubset}.json&quot;</span></span>
<span id="cb167-65"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-65"></a>    <span class="ex">output</span>:</span>
<span id="cb167-66"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-66"></a>        <span class="ex">estimate</span> = <span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span></span>
<span id="cb167-67"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-67"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-68"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-68"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb167-69"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-69"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb167-70"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-70"></a><span class="st">            --model {input.model} \</span></span>
<span id="cb167-71"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-71"></a><span class="st">            --subset {input.subset} \</span></span>
<span id="cb167-72"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-72"></a><span class="st">            --out {output.estimate}&quot;</span></span>
<span id="cb167-73"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-73"></a></span>
<span id="cb167-74"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-74"></a><span class="ex">rule</span> figure:</span>
<span id="cb167-75"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-75"></a>    <span class="ex">input</span>:</span>
<span id="cb167-76"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-76"></a>        <span class="ex">script</span> = <span class="st">&quot;src/figures/{iFigure}.R&quot;</span>,</span>
<span id="cb167-77"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-77"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span>,</span>
<span id="cb167-78"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-78"></a>        <span class="ex">subset</span> = <span class="st">&quot;src/data-specs/subset_intermediate.json&quot;</span></span>
<span id="cb167-79"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-79"></a>    <span class="ex">output</span>:</span>
<span id="cb167-80"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-80"></a>        <span class="ex">fig</span> = <span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span></span>
<span id="cb167-81"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-81"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-82"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-82"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb167-83"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-83"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb167-84"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-84"></a><span class="st">            --subset {input.subset} \</span></span>
<span id="cb167-85"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-85"></a><span class="st">            --out {output.fig}&quot;</span></span>
<span id="cb167-86"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-86"></a></span>
<span id="cb167-87"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-87"></a><span class="ex">rule</span> gen_regression_vars:</span>
<span id="cb167-88"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-88"></a>    <span class="ex">input</span>:</span>
<span id="cb167-89"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-89"></a>        <span class="ex">script</span> = <span class="st">&quot;src/data-management/gen_reg_vars.R&quot;</span>,</span>
<span id="cb167-90"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-90"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_renamed.csv&quot;</span>,</span>
<span id="cb167-91"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-91"></a>        <span class="ex">param</span>  = <span class="st">&quot;src/data-specs/param_solow.json&quot;</span></span>
<span id="cb167-92"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-92"></a>    <span class="ex">output</span>:</span>
<span id="cb167-93"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-93"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span></span>
<span id="cb167-94"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-94"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-95"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-95"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb167-96"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-96"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb167-97"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-97"></a><span class="st">            --param {input.param} \</span></span>
<span id="cb167-98"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-98"></a><span class="st">            --out {output.data}&quot;</span></span>
<span id="cb167-99"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-99"></a></span>
<span id="cb167-100"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-100"></a><span class="ex">rule</span> rename_vars:</span>
<span id="cb167-101"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-101"></a>    <span class="ex">input</span>:</span>
<span id="cb167-102"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-102"></a>        <span class="ex">script</span> = <span class="st">&quot;src/data-management/rename_variables.R&quot;</span>,</span>
<span id="cb167-103"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-103"></a>        <span class="ex">data</span>   = <span class="st">&quot;src/data/mrw.dta&quot;</span></span>
<span id="cb167-104"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-104"></a>    <span class="ex">output</span>:</span>
<span id="cb167-105"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-105"></a>        <span class="ex">data</span> = <span class="st">&quot;out/data/mrw_renamed.csv&quot;</span></span>
<span id="cb167-106"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-106"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-107"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-107"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb167-108"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-108"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb167-109"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-109"></a><span class="st">            --out {output.data}&quot;</span></span>
<span id="cb167-110"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-110"></a></span>
<span id="cb167-111"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-111"></a></span>
<span id="cb167-112"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-112"></a><span class="co">##############################################</span></span>
<span id="cb167-113"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-113"></a><span class="co"># CLEANING RULES</span></span>
<span id="cb167-114"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-114"></a><span class="co">##############################################</span></span>
<span id="cb167-115"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-115"></a></span>
<span id="cb167-116"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-116"></a><span class="ex">rule</span> clean:</span>
<span id="cb167-117"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-117"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-118"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-118"></a>        <span class="st">&quot;rm -rf out/*&quot;</span></span>
<span id="cb167-119"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-119"></a></span>
<span id="cb167-120"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-120"></a><span class="ex">rule</span> clean_data:</span>
<span id="cb167-121"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-121"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-122"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-122"></a>        <span class="st">&quot;rm -rf out/data/*&quot;</span></span>
<span id="cb167-123"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-123"></a></span>
<span id="cb167-124"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-124"></a><span class="ex">rule</span> clean_analysis:</span>
<span id="cb167-125"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-125"></a>    <span class="ex">shell</span>:</span>
<span id="cb167-126"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb167-126"></a>        <span class="st">&quot;rm -rf out/analysis/*&quot;</span></span></code></pre></div>
</div>
<div id="where-we-are" class="section level2">
<h2><span class="header-section-number">11.3</span> Where We Are</h2>
<p>In the last chapter we constructed a new target rule,
which we called <code>all</code>,
to combine the table and figure outputs.
This enabled us to be able to run the whole project from start to finish with the command <code>snakemake --cores 1</code>.
At this end point our workflow is illustrated by the following rulegraph:</p>
<p><img src="img/33-paper-slides/rulegraph-all.png" style="display: block; margin: auto;" /></p>
<p>The possibility to end our workflow with the outputs of our data analysis is one possible end-point.
An alternative endpoint is to extend the workflow to also manage the build of the literate outputs of the project,
which in most cases is a paper and a set of slides.
In what follows we explore this extension.</p>
</div>
<div id="building-a-paper" class="section level2">
<h2><span class="header-section-number">11.4</span> Building a Paper</h2>
<p>Our project’s source files have everything we need to construct a paper:</p>
<ul>
<li>Data analytic outputs in the form of graphs and tables, in <code>out/figures</code> and <code>out/tables</code></li>
<li>Text of a short paper, located in <code>src/paper/</code></li>
<li>A script to construct the paper, located in <code>src/lib/build_article.R</code><a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></li>
</ul>
<p>This suggests that a rule to build a paper might look like the following:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb168-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-1"></a><span class="ex">rule</span> build_paper:</span>
<span id="cb168-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-2"></a>    <span class="ex">input</span>:</span>
<span id="cb168-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-3"></a>        <span class="ex">script</span> = <span class="st">&quot;src/lib/build_article.R&quot;</span>,</span>
<span id="cb168-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-4"></a>        <span class="op">&lt;</span><span class="ex">SOME</span> WAY TO ADD TABLES, FIGURES AND PAPER CONTENTS<span class="op">&gt;</span></span>
<span id="cb168-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-5"></a>    <span class="ex">output</span>:</span>
<span id="cb168-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-6"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb168-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-7"></a>    <span class="ex">shell</span>:</span>
<span id="cb168-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb168-8"></a>        <span class="st">&quot;Rscript {input.script} &lt;SOME_CLI_OPTIONS&gt;&quot;</span></span></code></pre></div>
<p>This is the structure we want to adopt.
To see how we can flesh out the remaining structure,
where <code>&lt;SOME...&gt;</code> suggests we need further specification,
let’s look at what the script <code>src/lib/build_article.R</code> expects as command line arguments:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb169-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb169-1"></a><span class="ex">Rscript</span> src/lib/build_article.R --help</span></code></pre></div>
<p>which yields:</p>
<pre class="out"><code>Usage: src/lib/build_article.R [options]


Options:
        -i CHARACTER, --index=CHARACTER
                Name of rmarkdown file where paper metadata is located

        -h, --help
                Show this help message and exit
</code></pre>
<p>This tells us we need to find an Rmarkdown file with the paper metadata.
Intuitively, the project’s structure tells us we should look for a file in <code>src/paper</code>.
Let’s do just that:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb171-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb171-1"></a><span class="fu">ls</span> src/paper</span></code></pre></div>
<p>which returns the following:</p>
<pre class="out"><code>01-intro.Rmd       03-data.Rmd     _bookdown.yml  _output.yml   references.bib
02-literature.Rmd  04-results.Rmd  index.Rmd      preamble.tex</code></pre>
<p>There’s a lot there.
The file we are after is <code>index.Rmd</code>.
So let’s update our rule <code>build_paper</code> with what we have learned:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb173-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-1"></a><span class="ex">rule</span> build_paper:</span>
<span id="cb173-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-2"></a>    <span class="ex">input</span>:</span>
<span id="cb173-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-3"></a>        <span class="ex">script</span> = <span class="st">&quot;src/lib/build_article.R&quot;</span>,</span>
<span id="cb173-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-4"></a>        <span class="ex">index</span>  = <span class="st">&quot;src/paper/index.Rmd&quot;</span></span>
<span id="cb173-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-5"></a>        <span class="op">&lt;</span><span class="ex">SOME</span> WAY TO ADD TABLES, FIGURES AND PAPER CONTENTS<span class="op">&gt;</span></span>
<span id="cb173-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-6"></a>    <span class="ex">output</span>:</span>
<span id="cb173-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-7"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb173-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-8"></a>    <span class="ex">shell</span>:</span>
<span id="cb173-9"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb173-9"></a>        <span class="st">&quot;Rscript {input.script} --index {input.index}&quot;</span></span></code></pre></div>
<p>Now, there is a lot of other files in <code>src/paper/</code> apart from <code>index.Rmd</code>.
Here’s a brief summary of what they do:</p>
<ul>
<li><code>01-intro.Rmd</code>, … <code>04-results.Rmd</code> contain the textual content of the paper,
and insert the figures and tables where we need them.
Each file is a section of the paper, and files are numbered in the order we want the sections to appear.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></li>
<li><code>preamble.tex</code> contains some additional latex packages and environments we need to build the article</li>
<li><code>references.bib</code> contains any references we will cite in the paper, in BIBTeX format.</li>
<li><code>agsm.bst</code> formats our bibliography.</li>
<li><code>_bookdown.yml</code> - a file that tells <code>R</code> where we want the output to be saved, and what to call it.
We’ve set that up to be saved in <code>out/paper/</code> and the filename be <code>paper.pdf</code>.</li>
<li><code>_output.yml</code> - a file that tells <code>R</code> how to construct the paper, i.e. what template we need, and if we need other latex packages.</li>
</ul>
<p>We need all these files to be inputs to the rule <code>build_paper</code>.
This is so a rebuild of the paper is triggered any time we change on of these files.
We could manually specify each one, or we could use the notion of <code>glob_wildcards</code> to collect the files by name,
and then use <code>expand()</code> to include all of these files in the rule.
First, let’s do the <code>glob_wildcards</code> step - we want all files in <code>src/paper</code>:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb174-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb174-1"></a><span class="ex">TABLES</span> = ...</span>
<span id="cb174-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb174-2"></a></span>
<span id="cb174-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb174-3"></a><span class="ex">PAPER_FILES</span>  = glob_wildcards(<span class="st">&quot;src/paper/{fname}&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb174-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb174-4"></a></span>
<span id="cb174-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb174-5"></a><span class="co">##############################################</span></span></code></pre></div>
<p>And then we update the rule <code>build_paper</code> once more to <code>expand</code> over all files we found in the <code>glob_wildcards</code> step:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb175-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-1"></a><span class="ex">rule</span> build_paper:</span>
<span id="cb175-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-2"></a>    <span class="ex">input</span>:</span>
<span id="cb175-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-3"></a>        <span class="ex">script</span> = <span class="st">&quot;src/lib/build_article.R&quot;</span>,</span>
<span id="cb175-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-4"></a>        <span class="ex">paper</span>  = PAPER_FILES</span>
<span id="cb175-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-5"></a>        <span class="op">&lt;</span><span class="ex">SOME</span> WAY TO ADD TABLES AND FIGURES<span class="op">&gt;</span></span>
<span id="cb175-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-6"></a>    <span class="ex">output</span>:</span>
<span id="cb175-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-7"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb175-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-8"></a>    <span class="ex">shell</span>:</span>
<span id="cb175-9"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb175-9"></a>        <span class="st">&quot;Rscript {input.script} --index src/paper/index.Rmd&quot;</span></span></code></pre></div>
<p>Finally we need to add the figures and tables as inputs.
We’ll use the <code>expand</code> function to iterate over the <code>FIGURES</code> and and <code>TABLES</code> lists we previously created.
The <code>build_paper</code> rule is now:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb176-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-1"></a><span class="ex">rule</span> build_paper:</span>
<span id="cb176-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-2"></a>    <span class="ex">input</span>:</span>
<span id="cb176-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-3"></a>        <span class="ex">script</span>  = <span class="st">&quot;src/lib/build_article.R&quot;</span>,</span>
<span id="cb176-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-4"></a>        <span class="ex">paper</span>   = PAPER_FILES</span>
<span id="cb176-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-5"></a>        <span class="ex">figures</span> = expand(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,</span>
<span id="cb176-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-6"></a>                    <span class="ex">iFigure</span> = PLOTS),</span>
<span id="cb176-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-7"></a>        <span class="ex">tables</span>  = expand(<span class="st">&quot;out/tables/{iTable}.tex&quot;</span>,</span>
<span id="cb176-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-8"></a>                    <span class="ex">iTable</span> = TABLES) </span>
<span id="cb176-9"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-9"></a>    <span class="ex">output</span>:</span>
<span id="cb176-10"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-10"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb176-11"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-11"></a>    <span class="ex">shell</span>:</span>
<span id="cb176-12"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb176-12"></a>        <span class="st">&quot;Rscript {input.script} --index src/paper/index.Rmd&quot;</span></span></code></pre></div>
<p>To build the rule with Snakemake:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb177-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb177-1"></a><span class="ex">snakemake</span> --cores 1 build_paper</span></code></pre></div>
<p>At the conclusion of the run, we see that the file <code>out/paper/paper.pdf</code> is produced.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb178-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb178-1"></a><span class="fu">ls</span> out/paper</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb179-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb179-1"></a><span class="ex">paper.pdf</span>  paper.tex</span></code></pre></div>
<p>We also see that the tex file <code>paper.tex</code> is produced.
This can be useful when it’s time to submit the final version of paper to a journal after acceptance -
they most likely don’t want all our <code>Rmd</code>s!.</p>
</div>
<div id="integrating-build_paper-output-into-all" class="section level2">
<h2><span class="header-section-number">11.5</span> Integrating <code>build_paper</code> output into <code>all</code></h2>
<p>Let’s compare the rules that need to be executed when we run
<code>snakemake --cores 1 build_paper</code> and <code>snakemake --cores 1 all</code>:</p>
<p>!! TODO add some space between, captions etc</p>
<p><img src="img/33-paper-slides/rulegraph-all.png" width="50%" /><img src="img/33-paper-slides/rulegraph-build-paper.png" width="50%" /></p>
<p>We see that they are the same.
The reason is that the <code>build_paper</code> rule has all of the figures and tables included.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>
This suggests we can update the <code>all</code> rule.
We’ll update it by removing the figures and tables as inputs, and replacing them with the paper we produced:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb180-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb180-1"></a><span class="ex">rule</span> all:</span>
<span id="cb180-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb180-2"></a>    <span class="ex">input</span>:</span>
<span id="cb180-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb180-3"></a>        <span class="ex">paper</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span></code></pre></div>
<p>Now when we execute Snakemake with <code>snakemake --cores 1 all</code> it will run the full workflow including the paper build.
That is, our rule graph becomes:</p>
<p><img src="img/33-paper-slides/rulegraph-all-with-paper.png" style="display: block; margin: auto;" /></p>
<p>To see this in action, let’s clean our output directory:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb181-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb181-1"></a><span class="ex">snakemake</span> --cores 1 clean</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb182-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb182-1"></a><span class="ex">snakemake</span> --cores 1 all</span></code></pre></div>
<p>!! TO DO include snippet from snakemake output.</p>
<p>The end OR beginning shows that the <code>all</code> rule now builds the paper after running all the data cleaning,
model estimations, and the figure &amp; table creation.</p>
<p>!! TIP: What to do if paper doesn’t include all tables and figs?</p>
<p>Sometimes our final paper may not include all the tables and figures we have created.
The question is then what do we want to do, and do we need to make all the additional tables and figures?</p>
<p>Here’s some thoughts on likely situations you could encounter and a possible solution:</p>
<ul>
<li><p>If the additional tables and figures aren’t needed for the project, we don’t need to build them.
Adjust the inputs to <code>build_paper</code> to only include what is needed, and don’t build them all.</p></li>
<li><p>If the additional tables and figures are needed, but they aren’t included in the final paper.
This means they are likely going to be part of a long web appendix.
Create a rule to build the web appendix, and then add the final web appendix doc as a input to the <code>all</code> rule</p></li>
<li><p>If the additional tables and figures are needed, but they aren’t included in any of the final documents.
One could leave the tables and figs as part of the <code>all</code> rule in addition to the paper.</p></li>
</ul>
</div>
<div id="making-paper.pdf-easier-to-find" class="section level2">
<h2><span class="header-section-number">11.6</span> Making <code>paper.pdf</code> Easier to Find</h2>
<p>So far we have used the <code>all</code> rule like any other target rule -
we specify a set of inputs we want to have built.
Our current <code>all</code> rule builds the final paper and any of its dependencies,
but there is nothing stopping us from extending this rule to work more for us, by taking the inputs
and doing something to them via shell command to create new outputs.
What we have in mind is taking the paper located in <code>out/paper/paper.pdf</code> and copying it to the project’s
root directory so it is easy to find.</p>
<p>Let’s do this by adding some additional structure to the <code>all</code> rule:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb183-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-1"></a><span class="ex">rule</span> all:</span>
<span id="cb183-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-2"></a>    <span class="ex">input</span>:</span>
<span id="cb183-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-3"></a>        <span class="ex">paper</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb183-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-4"></a>    <span class="ex">output</span>:</span>
<span id="cb183-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-5"></a>        <span class="ex">paper</span> = </span>
<span id="cb183-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-6"></a>    <span class="ex">shell</span>:</span>
<span id="cb183-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb183-7"></a>        <span class="st">&quot;&lt;MIX IT&gt;&quot;</span></span></code></pre></div>
<p>We want to create a copy of the paper, and put it in the root directory, so we can create the output as “paper.pdf.”<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>
And then we can copy from one directory to another using the <code>cp</code> command.
The first argument after <code>cp</code> is what we want to copy - in our case <code>{input.paper}</code>,
and the last is where we want to copy the file to - which is <code>{output.paper}</code> for us.
Let’s make those changes:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb184-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-1"></a><span class="ex">rule</span> all:</span>
<span id="cb184-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-2"></a>    <span class="ex">input</span>:</span>
<span id="cb184-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-3"></a>        <span class="ex">paper</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb184-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-4"></a>    <span class="ex">output</span>:</span>
<span id="cb184-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-5"></a>        <span class="ex">paper</span> = <span class="st">&quot;paper.pdf&quot;</span></span>
<span id="cb184-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-6"></a>    <span class="ex">shell</span>:</span>
<span id="cb184-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb184-7"></a>        <span class="st">&quot;cp {input.paper} {output.paper}&quot;</span></span></code></pre></div>
<p>Now run the <code>all</code> rule:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb185-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb185-1"></a><span class="ex">snakemake</span> --cores 1 all</span></code></pre></div>
<p>and then look at the contents of the project’s root directory:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb186-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb186-1"></a><span class="fu">ls</span> . </span></code></pre></div>
<pre class="out"><code>find_r_packages.sh    out/       README.md         config.yaml          
install_r_packages.R  paper.pdf  REQUIREMENTS.txt  sandbox/       Snakefile</code></pre>
<p>And we can now see a copy of the paper located in the root directory, as desired.
Now everytime we run <code>all</code>, the latest copy of the paper will be easily available in the root direcroty.</p>
<div id="exercise-adding-a-slide-deck." class="section level3">
<h3><span class="header-section-number">11.6.1</span> Exercise: Adding a Slide Deck.</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Create a rule <code>build_slides</code> that uses <code>src/lib/build_slides.Rmd</code> to produce a slide deck that is saved to <code>out/slides/slides.pdf</code>
The slide content is the in folder <code>src/slides</code>.</p></li>
<li><p>Our slides only use one table (<code>table06.tex</code>) and one figure (<code>uncondtional convergence</code>).
Did you chose to include all figures and tables as inputs? Why or why not?</p></li>
<li><p>Add the slide output to the <code>all</code> rule, and make sure the all rule copies them across to the project’s root directory.
(HINT: you can chain together copy commands in the shell with <code>&amp;&amp;</code>)</p></li>
</ol>
</div>
<div id="exercise-solution" class="section level3">
<h3><span class="header-section-number">11.6.2</span> Exercise Solution</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb188-1"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-1"></a><span class="ex">MODELS</span> = glob_wildcards(<span class="st">&quot;src/model-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span> </span>
<span id="cb188-2"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-2"></a></span>
<span id="cb188-3"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-3"></a><span class="co"># note this filter is only needed coz we are running an older version of the src files, will be updated soon</span></span>
<span id="cb188-4"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-4"></a><span class="ex">DATA_SUBSET</span> = glob_wildcards(<span class="st">&quot;src/data-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb188-5"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-5"></a><span class="ex">DATA_SUBSET</span> = list(filter(lambda x: x.startswith(<span class="st">&quot;subset&quot;</span>), <span class="ex">DATA_SUBSET</span>))</span>
<span id="cb188-6"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-6"></a></span>
<span id="cb188-7"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-7"></a><span class="ex">PLOTS</span> = glob_wildcards(<span class="st">&quot;src/figures/{fname}.R&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb188-8"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-8"></a></span>
<span id="cb188-9"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-9"></a><span class="ex">TABLES</span> = glob_wildcards(<span class="st">&quot;src/table-specs/{fname}.json&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb188-10"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-10"></a><span class="ex">PAPER_FILES</span>  = glob_wildcards(<span class="st">&quot;src/paper/{fname}&quot;</span>)<span class="ex">.fname</span></span>
<span id="cb188-11"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-11"></a></span>
<span id="cb188-12"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-12"></a><span class="co">##############################################</span></span>
<span id="cb188-13"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-13"></a><span class="co"># TARGETS</span></span>
<span id="cb188-14"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-14"></a><span class="co">##############################################</span></span>
<span id="cb188-15"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-15"></a></span>
<span id="cb188-16"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-16"></a><span class="ex">rule</span> all:</span>
<span id="cb188-17"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-17"></a>    <span class="ex">input</span>:</span>
<span id="cb188-18"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-18"></a>        <span class="ex">paper</span>  = <span class="st">&quot;out/paper/paper.pdf&quot;</span>,</span>
<span id="cb188-19"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-19"></a>        <span class="ex">slides</span> = <span class="st">&quot;out/slides/slides.pdf&quot;</span></span>
<span id="cb188-20"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-20"></a>    <span class="ex">output</span>:</span>
<span id="cb188-21"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-21"></a>        <span class="ex">paper</span>  = <span class="st">&quot;paper.pdf&quot;</span>,</span>
<span id="cb188-22"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-22"></a>        <span class="ex">slides</span> = <span class="st">&quot;slides.pdf&quot;</span></span>
<span id="cb188-23"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-23"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-24"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-24"></a>        <span class="st">&quot;cp {input.paper} {output.paper} &amp;&amp; cp {input.slides} {output.slides}&quot;</span></span>
<span id="cb188-25"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-25"></a></span>
<span id="cb188-26"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-26"></a><span class="ex">rule</span> make_tables:</span>
<span id="cb188-27"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-27"></a>    <span class="ex">input</span>:</span>
<span id="cb188-28"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-28"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/tables/{iTable}.tex&quot;</span>,</span>
<span id="cb188-29"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-29"></a>                <span class="ex">iTable</span> = TABLES)</span>
<span id="cb188-30"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-30"></a></span>
<span id="cb188-31"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-31"></a><span class="ex">rule</span> run_models:</span>
<span id="cb188-32"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-32"></a>    <span class="ex">input</span>:</span>
<span id="cb188-33"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-33"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span>,</span>
<span id="cb188-34"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-34"></a>                    <span class="ex">iSubset</span> = DATA_SUBSET,</span>
<span id="cb188-35"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-35"></a>                    <span class="ex">iModel</span> = MODELS)</span>
<span id="cb188-36"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-36"></a></span>
<span id="cb188-37"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-37"></a><span class="ex">rule</span> make_figures:</span>
<span id="cb188-38"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-38"></a>    <span class="ex">input</span>:</span>
<span id="cb188-39"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-39"></a>        <span class="ex">expand</span>(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,</span>
<span id="cb188-40"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-40"></a>                    <span class="ex">iFigure</span> = PLOTS)</span>
<span id="cb188-41"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-41"></a></span>
<span id="cb188-42"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-42"></a></span>
<span id="cb188-43"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-43"></a><span class="co">##############################################</span></span>
<span id="cb188-44"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-44"></a><span class="co"># INTERMEDIATE RULES</span></span>
<span id="cb188-45"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-45"></a><span class="co">##############################################</span></span>
<span id="cb188-46"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-46"></a></span>
<span id="cb188-47"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-47"></a><span class="ex">rule</span> build_slides:</span>
<span id="cb188-48"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-48"></a>    <span class="ex">input</span>:</span>
<span id="cb188-49"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-49"></a>        <span class="ex">script</span>    = <span class="st">&quot;src/lib/build_slides.R&quot;</span>,</span>
<span id="cb188-50"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-50"></a>        <span class="ex">index</span>     = <span class="st">&quot;src/slides/slides.Rmd&quot;</span>,</span>
<span id="cb188-51"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-51"></a>        <span class="ex">table</span>     = <span class="st">&quot;out/tables/table_06.tex&quot;</span>,</span>
<span id="cb188-52"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-52"></a>        <span class="ex">figure</span>    = <span class="st">&quot;out/figures/unconditional_convergence.pdf&quot;</span>,</span>
<span id="cb188-53"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-53"></a>        <span class="ex">preamble</span>  = <span class="st">&quot;src/slides/preamble.tex&quot;</span></span>
<span id="cb188-54"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-54"></a>    <span class="ex">output</span>:</span>
<span id="cb188-55"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-55"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/slides/slides.pdf&quot;</span></span>
<span id="cb188-56"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-56"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-57"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-57"></a>        <span class="st">&quot;Rscript {input.script} --index {input.index} --output {output.pdf}&quot;</span> </span>
<span id="cb188-58"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-58"></a></span>
<span id="cb188-59"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-59"></a><span class="ex">rule</span> build_paper:</span>
<span id="cb188-60"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-60"></a>    <span class="ex">input</span>:</span>
<span id="cb188-61"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-61"></a>        <span class="ex">script</span> = <span class="st">&quot;src/lib/build_article.R&quot;</span>,</span>
<span id="cb188-62"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-62"></a>        <span class="ex">paper</span>  = expand(<span class="st">&quot;src/paper/{iPaper}&quot;</span>,</span>
<span id="cb188-63"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-63"></a>                          <span class="ex">iPaper</span> = PAPER_FILES),</span>
<span id="cb188-64"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-64"></a>        <span class="ex">figures</span> = expand(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,</span>
<span id="cb188-65"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-65"></a>                    <span class="ex">iFigure</span> = PLOTS),</span>
<span id="cb188-66"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-66"></a>        <span class="ex">tables</span>  = expand(<span class="st">&quot;out/tables/{iTable}.tex&quot;</span>,</span>
<span id="cb188-67"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-67"></a>                    <span class="ex">iTable</span> = TABLES) </span>
<span id="cb188-68"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-68"></a>    <span class="ex">output</span>:</span>
<span id="cb188-69"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-69"></a>        <span class="ex">pdf</span> = <span class="st">&quot;out/paper/paper.pdf&quot;</span></span>
<span id="cb188-70"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-70"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-71"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-71"></a>        <span class="st">&quot;Rscript {input.script} --index src/paper/index.Rmd&quot;</span></span>
<span id="cb188-72"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-72"></a></span>
<span id="cb188-73"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-73"></a></span>
<span id="cb188-74"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-74"></a><span class="co"># table: build one table</span></span>
<span id="cb188-75"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-75"></a><span class="ex">rule</span> table:</span>
<span id="cb188-76"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-76"></a>    <span class="ex">input</span>:</span>
<span id="cb188-77"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-77"></a>        <span class="ex">script</span> = <span class="st">&quot;src/tables/regression_table.R&quot;</span>,</span>
<span id="cb188-78"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-78"></a>        <span class="ex">spec</span>   = <span class="st">&quot;src/table-specs/{iTable}.json&quot;</span>,</span>
<span id="cb188-79"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-79"></a>        <span class="ex">models</span> = expand(<span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span>,</span>
<span id="cb188-80"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-80"></a>                        <span class="ex">iModel</span> = MODELS,</span>
<span id="cb188-81"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-81"></a>                        <span class="ex">iSubset</span> = DATA_SUBSET),</span>
<span id="cb188-82"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-82"></a>    <span class="ex">output</span>:</span>
<span id="cb188-83"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-83"></a>        <span class="ex">table</span> = <span class="st">&quot;out/tables/{iTable}.tex&quot;</span></span>
<span id="cb188-84"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-84"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-85"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-85"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb188-86"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-86"></a><span class="st">            --spec {input.spec} \</span></span>
<span id="cb188-87"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-87"></a><span class="st">            --out {output.table}&quot;</span></span>
<span id="cb188-88"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-88"></a></span>
<span id="cb188-89"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-89"></a><span class="ex">rule</span> model:</span>
<span id="cb188-90"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-90"></a>    <span class="ex">input</span>:</span>
<span id="cb188-91"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-91"></a>        <span class="ex">script</span> = <span class="st">&quot;src/analysis/estimate_ols_model.R&quot;</span>,</span>
<span id="cb188-92"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-92"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span>,</span>
<span id="cb188-93"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-93"></a>        <span class="ex">model</span>  = <span class="st">&quot;src/model-specs/{iModel}.json&quot;</span>,</span>
<span id="cb188-94"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-94"></a>        <span class="ex">subset</span> = <span class="st">&quot;src/data-specs/{iSubset}.json&quot;</span></span>
<span id="cb188-95"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-95"></a>    <span class="ex">output</span>:</span>
<span id="cb188-96"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-96"></a>        <span class="ex">estimate</span> = <span class="st">&quot;out/analysis/{iModel}.{iSubset}.rds&quot;</span></span>
<span id="cb188-97"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-97"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-98"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-98"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb188-99"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-99"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb188-100"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-100"></a><span class="st">            --model {input.model} \</span></span>
<span id="cb188-101"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-101"></a><span class="st">            --subset {input.subset} \</span></span>
<span id="cb188-102"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-102"></a><span class="st">            --out {output.estimate}&quot;</span></span>
<span id="cb188-103"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-103"></a></span>
<span id="cb188-104"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-104"></a><span class="ex">rule</span> figure:</span>
<span id="cb188-105"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-105"></a>    <span class="ex">input</span>:</span>
<span id="cb188-106"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-106"></a>        <span class="ex">script</span> = <span class="st">&quot;src/figures/{iFigure}.R&quot;</span>,</span>
<span id="cb188-107"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-107"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span>,</span>
<span id="cb188-108"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-108"></a>        <span class="ex">subset</span> = <span class="st">&quot;src/data-specs/subset_intermediate.json&quot;</span></span>
<span id="cb188-109"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-109"></a>    <span class="ex">output</span>:</span>
<span id="cb188-110"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-110"></a>        <span class="ex">fig</span> = <span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span></span>
<span id="cb188-111"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-111"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-112"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-112"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb188-113"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-113"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb188-114"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-114"></a><span class="st">            --subset {input.subset} \</span></span>
<span id="cb188-115"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-115"></a><span class="st">            --out {output.fig}&quot;</span></span>
<span id="cb188-116"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-116"></a></span>
<span id="cb188-117"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-117"></a><span class="ex">rule</span> gen_regression_vars:</span>
<span id="cb188-118"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-118"></a>    <span class="ex">input</span>:</span>
<span id="cb188-119"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-119"></a>        <span class="ex">script</span> = <span class="st">&quot;src/data-management/gen_reg_vars.R&quot;</span>,</span>
<span id="cb188-120"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-120"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_renamed.csv&quot;</span>,</span>
<span id="cb188-121"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-121"></a>        <span class="ex">param</span>  = <span class="st">&quot;src/data-specs/param_solow.json&quot;</span></span>
<span id="cb188-122"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-122"></a>    <span class="ex">output</span>:</span>
<span id="cb188-123"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-123"></a>        <span class="ex">data</span>   = <span class="st">&quot;out/data/mrw_complete.csv&quot;</span></span>
<span id="cb188-124"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-124"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-125"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-125"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb188-126"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-126"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb188-127"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-127"></a><span class="st">            --param {input.param} \</span></span>
<span id="cb188-128"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-128"></a><span class="st">            --out {output.data}&quot;</span></span>
<span id="cb188-129"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-129"></a></span>
<span id="cb188-130"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-130"></a><span class="ex">rule</span> rename_vars:</span>
<span id="cb188-131"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-131"></a>    <span class="ex">input</span>:</span>
<span id="cb188-132"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-132"></a>        <span class="ex">script</span> = <span class="st">&quot;src/data-management/rename_variables.R&quot;</span>,</span>
<span id="cb188-133"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-133"></a>        <span class="ex">data</span>   = <span class="st">&quot;src/data/mrw.dta&quot;</span></span>
<span id="cb188-134"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-134"></a>    <span class="ex">output</span>:</span>
<span id="cb188-135"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-135"></a>        <span class="ex">data</span> = <span class="st">&quot;out/data/mrw_renamed.csv&quot;</span></span>
<span id="cb188-136"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-136"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-137"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-137"></a>        <span class="st">&quot;Rscript {input.script} \</span></span>
<span id="cb188-138"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-138"></a><span class="st">            --data {input.data} \</span></span>
<span id="cb188-139"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-139"></a><span class="st">            --out {output.data}&quot;</span></span>
<span id="cb188-140"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-140"></a></span>
<span id="cb188-141"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-141"></a></span>
<span id="cb188-142"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-142"></a><span class="co">##############################################</span></span>
<span id="cb188-143"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-143"></a><span class="co"># CLEANING RULES</span></span>
<span id="cb188-144"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-144"></a><span class="co">##############################################</span></span>
<span id="cb188-145"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-145"></a></span>
<span id="cb188-146"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-146"></a><span class="ex">rule</span> clean:</span>
<span id="cb188-147"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-147"></a>    <span class="ex">shell</span>:</span>
<span id="cb188-148"><a href="adding-papers-and-slides-to-a-snakemake-workflow.html#cb188-148"></a>        <span class="st">&quot;rm -rf out/*&quot;</span></span></code></pre></div>
</div>
</div>
<div id="final-thoughts" class="section level2">
<h2><span class="header-section-number">11.7</span> Final Thoughts</h2>
<p>!! TODO: Box titled: When to Extend the Workflow to Paper and Slides?</p>

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>
Note that the script to construct the paper is in <code>src/lib</code> rather than <code>src/paper</code>.
This is because the script <code>build_article.R</code> is quite general and can easily be used across multiple projects.
We like to put scripts that are not specific to the current project in <code>src/lib</code>.<a href="adding-papers-and-slides-to-a-snakemake-workflow.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>
By default, <code>bookdown</code> - our <code>R</code> package that builds the paper wants to insert files in an alpha-numeric order <em>after</em> <code>index.Rmd</code>.
We go along with this by numbering files in the order we want them.
There’s also a way to manually specify the order as a list of file names, but we think this numeric way is a bit easier.
(It also keeps the files in order in our directory so we can glimpse the structure and easily find the file we want to edit.)
<a href="adding-papers-and-slides-to-a-snakemake-workflow.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>
If we didn’t include <em>all</em> the tables and figures in the <code>build_paper</code>,
Snakemake would only build the ones required by that rule.
What we say below depends on all tables and figures being included.
We will have a remark on what to do if this is not the case in due course.<a href="adding-papers-and-slides-to-a-snakemake-workflow.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>
Note that by not putting any directory before <code>paper.pdf</code> it refers to the current directory (the project root) by default.<a href="adding-papers-and-slides-to-a-snakemake-workflow.html#fnref16" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-rule-to-rule-them-all.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="logging-output-and-errors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/lachlandeer/snakemake-econ-r/edit/master/33-paper_slides.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/lachlandeer/snakemake-econ-r/raw/master/33-paper_slides.Rmd"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
