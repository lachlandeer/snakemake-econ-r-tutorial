<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reproducible Research Workflows with Snakemake and R</title>
  <meta name="description" content="In progress">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Reproducible Research Workflows with Snakemake and R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="In progress" />
  <meta name="github-repo" content="lachlandeer/snakemake-econ-r-tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reproducible Research Workflows with Snakemake and R" />
  
  <meta name="twitter:description" content="In progress" />
  

<meta name="author" content="Lachlan Deer">
<meta name="author" content="Julian Langer">


<meta name="date" content="2019-02-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="automatic-wildcard-specifications.html">
<link rel="next" href="adding-parameters.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reproducible Research Workflows with Snakemake and `R`</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Motivating &amp; Rationale</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-case-for-reproducibility"><i class="fa fa-check"></i><b>1.1</b> A Case for Reproducibility</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#how-far-to-go-in-the-quest-for-reproducibility"><i class="fa fa-check"></i><b>1.1.1</b> How far to go in the quest for reproducibility?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-is-snakemake-why-should-you-use-it"><i class="fa fa-check"></i><b>1.2</b> What is <code>Snakemake</code> &amp; Why Should you use it?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#why-r"><i class="fa fa-check"></i><b>1.3</b> Why <code>R</code>?</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#working-example-replicating-mankiw-romer-and-weils-1992-qje"><i class="fa fa-check"></i><b>1.4</b> Working Example: Replicating Mankiw, Romer and Weil’s 1992 QJE</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#the-way-forward"><i class="fa fa-check"></i><b>1.5</b> The way forward</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#exercise-your-own-projects-steps"><i class="fa fa-check"></i>Exercise: Your own project’s steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i.html"><a href="part-i.html"><i class="fa fa-check"></i>PART I</a></li>
<li class="chapter" data-level="2" data-path="project-organization.html"><a href="project-organization.html"><i class="fa fa-check"></i><b>2</b> Project Organization</a><ul>
<li class="chapter" data-level="2.1" data-path="project-organization.html"><a href="project-organization.html#project-structure-i-separating-inputs-and-outputs"><i class="fa fa-check"></i><b>2.1</b> Project Structure I: Separating Inputs and Outputs</a><ul>
<li class="chapter" data-level="2.1.1" data-path="project-organization.html"><a href="project-organization.html#the-root-folder"><i class="fa fa-check"></i><b>2.1.1</b> The Root Folder</a></li>
<li class="chapter" data-level="2.1.2" data-path="project-organization.html"><a href="project-organization.html#the-src-folder"><i class="fa fa-check"></i><b>2.1.2</b> The <code>src</code> folder</a></li>
<li class="chapter" data-level="2.1.3" data-path="project-organization.html"><a href="project-organization.html#the-out-folder"><i class="fa fa-check"></i><b>2.1.3</b> The <code>out</code> folder</a></li>
<li class="chapter" data-level="2.1.4" data-path="project-organization.html"><a href="project-organization.html#the-log-folder"><i class="fa fa-check"></i><b>2.1.4</b> The <code>log</code> folder</a></li>
<li class="chapter" data-level="2.1.5" data-path="project-organization.html"><a href="project-organization.html#exploring-the-full-structure-of-the-mrw-replication-project"><i class="fa fa-check"></i><b>2.1.5</b> Exploring the Full Structure of the MRW Replication Project</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="project-organization.html"><a href="project-organization.html#project-structure-ii-separating-logical-chunks-of-the-project"><i class="fa fa-check"></i><b>2.2</b> Project Structure II: Separating Logical Chunks of the Project</a><ul>
<li class="chapter" data-level="2.2.1" data-path="project-organization.html"><a href="project-organization.html#exploring-the-structure-of-the-mrw-replication-subdirectories"><i class="fa fa-check"></i><b>2.2.1</b> Exploring the Structure of the MRW Replication Subdirectories</a></li>
<li class="chapter" data-level="" data-path="project-organization.html"><a href="project-organization.html#exercise-exploring-the-remaining-subdirectories"><i class="fa fa-check"></i>Exercise: Exploring the Remaining Subdirectories</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="project-organization.html"><a href="project-organization.html#project-structure-iii-separating-input-parameters-from-code"><i class="fa fa-check"></i><b>2.3</b> Project Structure III: Separating Input Parameters from Code</a><ul>
<li class="chapter" data-level="2.3.1" data-path="project-organization.html"><a href="project-organization.html#exploring-parameter-separation-in-the-mrw-replication-project"><i class="fa fa-check"></i><b>2.3.1</b> Exploring Parameter Separation in the MRW Replication Project</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html"><i class="fa fa-check"></i><b>3</b> Initial Steps with Snakemake</a><ul>
<li class="chapter" data-level="3.1" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#starting-a-research-project"><i class="fa fa-check"></i><b>3.1</b> Starting a Research Project</a></li>
<li class="chapter" data-level="3.2" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#the-beginning-of-a-snakefile"><i class="fa fa-check"></i><b>3.2</b> The Beginning of a Snakefile</a></li>
<li class="chapter" data-level="3.3" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#rule-structure"><i class="fa fa-check"></i><b>3.3</b> Rule Structure</a></li>
<li class="chapter" data-level="3.4" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#our-first-rule"><i class="fa fa-check"></i><b>3.4</b> Our First Rule</a><ul>
<li class="chapter" data-level="3.4.1" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#constructing-the-rule"><i class="fa fa-check"></i><b>3.4.1</b> Constructing the Rule</a></li>
<li class="chapter" data-level="3.4.2" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#analysing-output"><i class="fa fa-check"></i><b>3.4.2</b> Analysing Output</a></li>
<li class="chapter" data-level="" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#exercise-deleting-output"><i class="fa fa-check"></i>Exercise: Deleting Output</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#creating-a-second-rule"><i class="fa fa-check"></i><b>3.5</b> Creating a Second Rule</a><ul>
<li class="chapter" data-level="" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#exercise-creating-rules"><i class="fa fa-check"></i>Exercise: Creating Rules</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#clean-rules"><i class="fa fa-check"></i><b>3.6</b> Clean Rules</a><ul>
<li class="chapter" data-level="" data-path="initial-steps-with-snakemake.html"><a href="initial-steps-with-snakemake.html#exercise-creating-cleaning-rules"><i class="fa fa-check"></i>Exercise: Creating Cleaning Rules</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pattern-rules.html"><a href="pattern-rules.html"><i class="fa fa-check"></i><b>4</b> Pattern Rules</a><ul>
<li class="chapter" data-level="4.1" data-path="pattern-rules.html"><a href="pattern-rules.html#where-we-are-now"><i class="fa fa-check"></i><b>4.1</b> Where we are now?</a></li>
<li class="chapter" data-level="4.2" data-path="pattern-rules.html"><a href="pattern-rules.html#wildcards"><i class="fa fa-check"></i><b>4.2</b> Wildcards</a></li>
<li class="chapter" data-level="4.3" data-path="pattern-rules.html"><a href="pattern-rules.html#the-expand-function"><i class="fa fa-check"></i><b>4.3</b> The <code>expand()</code> function</a><ul>
<li class="chapter" data-level="" data-path="pattern-rules.html"><a href="pattern-rules.html#exercise-exploring-the-expand-function-i"><i class="fa fa-check"></i>Exercise: Exploring the expand() function I</a></li>
<li class="chapter" data-level="" data-path="pattern-rules.html"><a href="pattern-rules.html#exercise-exploring-the-expand-function-ii"><i class="fa fa-check"></i>Exercise: Exploring the expand function II</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="pattern-rules.html"><a href="pattern-rules.html#expanding-multiple-wildcards"><i class="fa fa-check"></i><b>4.4</b> Expanding Multiple Wildcards</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="automatic-wildcard-specifications.html"><a href="automatic-wildcard-specifications.html"><i class="fa fa-check"></i><b>5</b> Automatic Wildcard Specifications</a><ul>
<li class="chapter" data-level="5.1" data-path="automatic-wildcard-specifications.html"><a href="automatic-wildcard-specifications.html#the-glob_wildcards-function"><i class="fa fa-check"></i><b>5.1</b> The <code>glob_wildcards</code> Function</a><ul>
<li class="chapter" data-level="" data-path="automatic-wildcard-specifications.html"><a href="automatic-wildcard-specifications.html#exercise-exploring-glob_wildcards"><i class="fa fa-check"></i>Exercise: Exploring glob_wildcards()</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="automatic-wildcard-specifications.html"><a href="automatic-wildcard-specifications.html#further-restricting-the-glob_wildcards-output"><i class="fa fa-check"></i><b>5.2</b> Further Restricting the <code>glob_wildcards</code> output</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="building-all-outputs-at-once.html"><a href="building-all-outputs-at-once.html"><i class="fa fa-check"></i><b>6</b> Building all outputs at once</a><ul>
<li class="chapter" data-level="6.1" data-path="building-all-outputs-at-once.html"><a href="building-all-outputs-at-once.html#creating-an-all-rule"><i class="fa fa-check"></i><b>6.1</b> Creating an <code>all</code> rule</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="adding-parameters.html"><a href="adding-parameters.html"><i class="fa fa-check"></i><b>7</b> Adding Parameters</a></li>
<li class="chapter" data-level="8" data-path="logging-output-and-errors.html"><a href="logging-output-and-errors.html"><i class="fa fa-check"></i><b>8</b> Logging Output and Errors</a></li>
<li class="chapter" data-level="9" data-path="self-documenting-help.html"><a href="self-documenting-help.html"><i class="fa fa-check"></i><b>9</b> Self Documenting Help</a></li>
<li class="chapter" data-level="10" data-path="config-files.html"><a href="config-files.html"><i class="fa fa-check"></i><b>10</b> Config Files</a></li>
<li class="chapter" data-level="11" data-path="subworkflows-divide-and-conquer.html"><a href="subworkflows-divide-and-conquer.html"><i class="fa fa-check"></i><b>11</b> Subworkflows: Divide and Conquer</a></li>
<li class="chapter" data-level="" data-path="part-ii.html"><a href="part-ii.html"><i class="fa fa-check"></i>PART II</a></li>
<li class="chapter" data-level="12" data-path="reproducible-articles-with-rmd.html"><a href="reproducible-articles-with-rmd.html"><i class="fa fa-check"></i><b>12</b> Reproducible Articles with Rmd</a></li>
<li class="chapter" data-level="13" data-path="reproducible-slides-with-rmd.html"><a href="reproducible-slides-with-rmd.html"><i class="fa fa-check"></i><b>13</b> Reproducible Slides with Rmd</a></li>
<li class="chapter" data-level="14" data-path="package-dependencies-with-packrat.html"><a href="package-dependencies-with-packrat.html"><i class="fa fa-check"></i><b>14</b> Package Dependencies with Packrat</a></li>
<li class="chapter" data-level="15" data-path="containers.html"><a href="containers.html"><i class="fa fa-check"></i><b>15</b> Containers</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Research Workflows with Snakemake and <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="building-all-outputs-at-once" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Building all outputs at once</h1>
<p>In our analysis pipeline that we have constructed so far, we need to make two calls to snakemake to run all of our analysis:</p>
<ol style="list-style-type: decimal">
<li><code>snakemake estimate_models</code> - to estimate OLS regressions</li>
<li><code>snakemake make_figs</code> - to construct the figures</li>
</ol>
<p>Whilst this is not too time consuming, it would be desirable to only have to run Snakemake once and have all our analysis in (1) and (2) be executed. That is our next goal.</p>
<p>So that we are all starting from the same directory structure, let’s clean our output directory, removing all estimated models and figures:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">snakemake</span> clean</code></pre></div>
<p>Now if we list the contents of the <code>out</code> directory and any potential subdirectories:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">ls</span> -R out/</code></pre></div>
<p>we see that there are no contents remaining:</p>
<pre class="out"><code>out/:</code></pre>
<div id="creating-an-all-rule" class="section level2">
<h2><span class="header-section-number">6.1</span> Creating an <code>all</code> rule</h2>
<p>Out goal is to combine all the outputs from the <code>estimate_models</code> and <code>make_figs</code> rules. Let’s take a look at the structure of each of these rules so that we get a sense of what we might need to do., Here is the <code>estimate_models</code> rule:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">rule</span> estimate_models:
    <span class="kw">input</span>:
        <span class="kw">expand</span>(<span class="st">&quot;out/analysis/{iModel}_ols_{iSubset}.rds&quot;</span>,
                    <span class="kw">iModel</span> = MODELS,
                    <span class="kw">iSubset</span> = DATA_SUBSET)</code></pre></div>
<p>And the <code>make_figs</code> rule:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">rule</span> make_figs:
    <span class="kw">input</span>:
        <span class="kw">expand</span>(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,
                <span class="kw">iFigure</span> = FIGURES)</code></pre></div>
<p>These rules have a common structure: both having only an <code>input</code>. From other rules that we have written, we know that a rule can have multiple inputs if we name them. This suggests a way forward. We are going to create a new rule called <code>all</code> that contains two inputs, combining the inputs from the separate rules:<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>:</p>
<ol style="list-style-type: decimal">
<li><code>figs</code>, which contains the inputs from our <code>make_figs</code> rule</li>
<li><code>models</code>, which contains the inputs from our <code>estimate_models</code> rule</li>
</ol>
<p>As ever, we will have to be mindful that if we have multiple inputs, have the trailing commas located wherever one input is followed by another. Let’s put this rule as the first in our Snakefile:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># --- Build Rules --- #</span>

<span class="kw">rule</span> all:
    <span class="kw">input</span>:
        <span class="kw">figs</span>   = expand(<span class="st">&quot;out/figures/{iFigure}.pdf&quot;</span>,
                            <span class="kw">iFigure</span> = FIGURES),
        <span class="kw">models</span> = expand(<span class="st">&quot;out/analysis/{iModel}_ols_{iSubset}.rds&quot;</span>,
                            <span class="kw">iModel</span> = MODELS,
                            <span class="kw">iSubset</span> = DATA_SUBSET)</code></pre></div>
<p>Let’s check if this <code>all</code> rule does as desired - building all outputs. If we run <code>snakemake --dryrun all</code>, we get the following output:</p>
<pre class="out"><code>Building DAG of jobs...
Job counts:
    count   jobs
    1   all
    3   figures
    1   gen_regression_vars
    24  ols_model
    1   rename_vars
    30

[Tue Feb  5 16:23:01 2019]
rule rename_vars:
    input: src/data-management/rename_variables.R, src/data/mrw.dta
    output: out/data/mrw_renamed.csv
    jobid: 29


[Tue Feb  5 16:23:01 2019]
rule gen_regression_vars:
    input: src/data-management/gen_reg_vars.R, out/data/mrw_renamed.csv, src/data-specs/param_solow.json
    output: out/data/mrw_complete.csv
    jobid: 28


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_aug_cc_ols_subset_oecd.rds
    jobid: 1
    wildcards: iModel=model_aug_cc, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_solow_ols_subset_oecd.rds
    jobid: 2
    wildcards: iModel=model_solow, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow_restr.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_solow_restr_ols_subset_oecd.rds
    jobid: 4
    wildcards: iModel=model_solow_restr, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_cc.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_cc_ols_subset_oecd.rds
    jobid: 5
    wildcards: iModel=model_cc, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc_restr.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_aug_cc_restr_ols_subset_intermediate.rds
    jobid: 27
    wildcards: iModel=model_aug_cc_restr, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_aug_solow_ols_subset_intermediate.rds
    jobid: 9
    wildcards: iModel=model_aug_solow, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_aug_solow_ols_subset_nonoil.rds
    jobid: 13
    wildcards: iModel=model_aug_solow, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc_restr.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_aug_cc_restr_ols_subset_nonoil.rds
    jobid: 15
    wildcards: iModel=model_aug_cc_restr, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule figures:
    input: src/figures/aug_conditional_convergence.R, out/data/mrw_complete.csv, src/data-specs/subset_intermediate.json
    output: out/figures/aug_conditional_convergence.pdf
    jobid: 18
    wildcards: iFigure=aug_conditional_convergence


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_ucc.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_ucc_ols_subset_oecd.rds
    jobid: 25
    wildcards: iModel=model_ucc, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow_restr.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_aug_solow_restr_ols_subset_oecd.rds
    jobid: 26
    wildcards: iModel=model_aug_solow_restr, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc_restr.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_aug_cc_restr_ols_subset_oecd.rds
    jobid: 14
    wildcards: iModel=model_aug_cc_restr, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow.json, src/data-specs/subset_oecd.json
    output: out/analysis/model_aug_solow_ols_subset_oecd.rds
    jobid: 3
    wildcards: iModel=model_aug_solow, iSubset=subset_oecd


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_solow_ols_subset_intermediate.rds
    jobid: 7
    wildcards: iModel=model_solow, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_cc.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_cc_ols_subset_nonoil.rds
    jobid: 23
    wildcards: iModel=model_cc, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow_restr.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_solow_restr_ols_subset_intermediate.rds
    jobid: 10
    wildcards: iModel=model_solow_restr, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_aug_cc_ols_subset_intermediate.rds
    jobid: 11
    wildcards: iModel=model_aug_cc, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule figures:
    input: src/figures/unconditional_convergence.R, out/data/mrw_complete.csv, src/data-specs/subset_intermediate.json
    output: out/figures/unconditional_convergence.pdf
    jobid: 24
    wildcards: iFigure=unconditional_convergence


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_cc.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_cc_ols_subset_intermediate.rds
    jobid: 8
    wildcards: iModel=model_cc, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow_restr.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_solow_restr_ols_subset_nonoil.rds
    jobid: 12
    wildcards: iModel=model_solow_restr, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_solow.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_solow_ols_subset_nonoil.rds
    jobid: 16
    wildcards: iModel=model_solow, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_cc.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_aug_cc_ols_subset_nonoil.rds
    jobid: 17
    wildcards: iModel=model_aug_cc, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule figures:
    input: src/figures/conditional_convergence.R, out/data/mrw_complete.csv, src/data-specs/subset_intermediate.json
    output: out/figures/conditional_convergence.pdf
    jobid: 19
    wildcards: iFigure=conditional_convergence


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_ucc.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_ucc_ols_subset_intermediate.rds
    jobid: 20
    wildcards: iModel=model_ucc, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow_restr.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_aug_solow_restr_ols_subset_nonoil.rds
    jobid: 21
    wildcards: iModel=model_aug_solow_restr, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_ucc.json, src/data-specs/subset_nonoil.json
    output: out/analysis/model_ucc_ols_subset_nonoil.rds
    jobid: 22
    wildcards: iModel=model_ucc, iSubset=subset_nonoil


[Tue Feb  5 16:23:01 2019]
rule ols_model:
    input: src/analysis/estimate_ols_model.R, out/data/mrw_complete.csv, src/model-specs/model_aug_solow_restr.json, src/data-specs/subset_intermediate.json
    output: out/analysis/model_aug_solow_restr_ols_subset_intermediate.rds
    jobid: 6
    wildcards: iModel=model_aug_solow_restr, iSubset=subset_intermediate


[Tue Feb  5 16:23:01 2019]
localrule all:
    input: out/figures/conditional_convergence.pdf, out/figures/unconditional_convergence.pdf, out/figures/aug_conditional_convergence.pdf, out/analysis/model_solow_ols_subset_oecd.rds, out/analysis/model_aug_cc_restr_ols_subset_oecd.rds, out/analysis/model_solow_restr_ols_subset_oecd.rds, out/analysis/model_cc_ols_subset_oecd.rds, out/analysis/model_ucc_ols_subset_oecd.rds, out/analysis/model_aug_solow_restr_ols_subset_oecd.rds, out/analysis/model_aug_cc_ols_subset_oecd.rds, out/analysis/model_aug_solow_ols_subset_oecd.rds, out/analysis/model_solow_ols_subset_nonoil.rds, out/analysis/model_aug_cc_restr_ols_subset_nonoil.rds, out/analysis/model_solow_restr_ols_subset_nonoil.rds, out/analysis/model_cc_ols_subset_nonoil.rds, out/analysis/model_ucc_ols_subset_nonoil.rds, out/analysis/model_aug_solow_restr_ols_subset_nonoil.rds, out/analysis/model_aug_cc_ols_subset_nonoil.rds, out/analysis/model_aug_solow_ols_subset_nonoil.rds, out/analysis/model_solow_ols_subset_intermediate.rds, out/analysis/model_aug_cc_restr_ols_subset_intermediate.rds, out/analysis/model_solow_restr_ols_subset_intermediate.rds, out/analysis/model_cc_ols_subset_intermediate.rds, out/analysis/model_ucc_ols_subset_intermediate.rds, out/analysis/model_aug_solow_restr_ols_subset_intermediate.rds, out/analysis/model_aug_cc_ols_subset_intermediate.rds, out/analysis/model_aug_solow_ols_subset_intermediate.rds
    jobid: 0

Job counts:
    count   jobs
    1   all
    3   figures
    1   gen_regression_vars
    24  ols_model
    1   rename_vars
    30
</code></pre>
<p>The output shows that we have achieved our desired goal. The <code>all</code> rule builds all outputs. Notice that if you examine the order that Snakemake plans to execute the jobs that:</p>
<ol style="list-style-type: decimal">
<li>First the data management steps are executed to prepare data
<ul>
<li>This is what we would expect, as we cannot do any analysis without cleaned data</li>
</ul></li>
<li>The order in which the figures and regressions are executed are mixed together
<ul>
<li>This is because the figures and regression outputs do not depend on each other</li>
</ul></li>
</ol>
<p>Now we build our entire project<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">snakemake</span> all</code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>The name <code>all</code> is a convention, we could name it anything we please<a href="building-all-outputs-at-once.html#fnref5">↩</a></p></li>
<li id="fn6"><p>Notice that we placed the <code>all</code> rule as the first rule in our Snakefile. Snakemake’s default behaviour is to build the first rule in the file, so we could instead type only <code>snakemake</code> and get the same result.<a href="building-all-outputs-at-once.html#fnref6">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="automatic-wildcard-specifications.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="adding-parameters.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-all.Rmd",
"text": "Edit"
},
"download": ["book.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
